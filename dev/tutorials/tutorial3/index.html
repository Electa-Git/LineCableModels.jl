<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial 3 - Computing line parameters · LineCableModels.jl</title><meta name="title" content="Tutorial 3 - Computing line parameters · LineCableModels.jl"/><meta property="og:title" content="Tutorial 3 - Computing line parameters · LineCableModels.jl"/><meta property="twitter:title" content="Tutorial 3 - Computing line parameters · LineCableModels.jl"/><meta name="description" content="Documentation for LineCableModels.jl."/><meta property="og:description" content="Documentation for LineCableModels.jl."/><meta property="twitter:description" content="Documentation for LineCableModels.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/><script src="../../assets/custom.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="LineCableModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LineCableModels.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Contents</a></li><li><a class="tocitem" href="../tutorial1/">Tutorial 1 - Using the  materials library</a></li><li><a class="tocitem" href="../tutorial2/">Tutorial 2 - Building a cable design</a></li><li class="is-active"><a class="tocitem" href>Tutorial 3 - Computing line parameters</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Getting-started"><span>Getting started</span></a></li><li><a class="tocitem" href="#Cable-dimensions"><span>Cable dimensions</span></a></li><li><a class="tocitem" href="#Core-and-main-insulation"><span>Core and main insulation</span></a></li><li><a class="tocitem" href="#Examining-the-cable-parameters-(RLC)"><span>Examining the cable parameters (RLC)</span></a></li><li><a class="tocitem" href="#Saving-the-cable-design"><span>Saving the cable design</span></a></li><li><a class="tocitem" href="#PSCAD-export"><span>PSCAD export</span></a></li><li><a class="tocitem" href="#FEM-calculations"><span>FEM calculations</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../reference/">Toolbox reference</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Development</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../TODO/">TODO</a></li><li><a class="tocitem" href="../../CHANGELOG/">Changelog</a></li></ul></li><li><a class="tocitem" href="../../bib/">Bibliography</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Tutorial 3 - Computing line parameters</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial 3 - Computing line parameters</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Electa-Git/LineCableModels.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Electa-Git/LineCableModels.jl/blob/main/examples/tutorial3.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial-3-Computing-line-parameters"><a class="docs-heading-anchor" href="#Tutorial-3-Computing-line-parameters">Tutorial 3 - Computing line parameters</a><a id="Tutorial-3-Computing-line-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial-3-Computing-line-parameters" title="Permalink"></a></h1><p>This case file demonstrates how to model an armored high-voltage single-core power cable using the <a href="../../#LineCableModels.jl"><code>LineCableModels.jl</code></a> package. The objective is to build a complete representation of a single-core 525 kV cable with a 1600 mm² copper conductor, 1.2 mm tubular lead sheath and 68 x 6 mm galvanized steel armor, based on the design described in [<a href="../../bib/#Karmokar2025">13</a>].</p><p><strong>Tutorial outline</strong></p><ul><li><a href="#Introduction">Introduction</a></li><li><a href="#Getting-started">Getting started</a></li><li><a href="#Cable-dimensions">Cable dimensions</a></li><li><a href="#Core-and-main-insulation">Core and main insulation</a></li><li class="no-marker"><ul><li><a href="#Inner-semiconductor">Inner semiconductor</a></li><li><a href="#Main-insulation">Main insulation</a></li><li><a href="#Outer-semiconductor">Outer semiconductor</a></li><li><a href="#Lead-screen/sheath">Lead screen/sheath</a></li><li><a href="#Armor-and-outer-jacket-components">Armor and outer jacket components</a></li></ul></li><li><a href="#Examining-the-cable-parameters-(RLC)">Examining the cable parameters (RLC)</a></li><li><a href="#Saving-the-cable-design">Saving the cable design</a></li><li class="no-marker"><ul><li><a href="#Defining-a-cable-system">Defining a cable system</a></li><li><a href="#Earth-model">Earth model</a></li><li><a href="#Underground-bipole-configuration">Underground bipole configuration</a></li><li><a href="#Cable-system-preview">Cable system preview</a></li></ul></li><li><a href="#PSCAD-export">PSCAD export</a></li><li><a href="#FEM-calculations">FEM calculations</a></li></ul><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>HVDC cables are constructed around a central conductor enclosed by a triple-extruded insulation system (inner/outer semi-conductive layers and main insulation). A metallic screen and protective outer sheath are then applied for land cables. Subsea designs add galvanized steel wire armor over this structure to provide mechanical strength against water pressure. A reference design for a 525 kV HVDC cable <a href="https://nkt.widen.net/content/pnwgwjfudf/pdf/Extruded_DC_525kV_DS_EN_DEHV_HV_DS_DE-EN.pdf">is shown here</a>.</p><h2 id="Getting-started"><a class="docs-heading-anchor" href="#Getting-started">Getting started</a><a id="Getting-started-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-started" title="Permalink"></a></h2><p>Load the package and set up the environment:</p><pre><code class="language- hljs">push!(LOAD_PATH, joinpath(@__DIR__, &quot;..&quot;, &quot;src&quot;)) # hide
using DataFrames
using LineCableModels</code></pre><p>Initialize materials library with default values:</p><pre><code class="language- hljs">materials_db = MaterialsLibrary(add_defaults=true)</code></pre><p>Include the required materials for this design:</p><pre><code class="language- hljs">lead = Material(21.4e-8, 1.0, 0.999983, 20.0, 0.00400) # Lead or lead alloy
store_materialslibrary!(materials_db, &quot;lead&quot;, lead)
steel = Material(13.8e-8, 1.0, 300.0, 20.0, 0.00450) # Steel
store_materialslibrary!(materials_db, &quot;steel&quot;, steel)
pp = Material(1e15, 2.8, 1.0, 20.0, 0.0) # Laminated paper propylene
store_materialslibrary!(materials_db, &quot;pp&quot;, pp)</code></pre><p>Inspect the contents of the materials library:</p><pre><code class="language- hljs">list_materialslibrary(materials_db)</code></pre><h2 id="Cable-dimensions"><a class="docs-heading-anchor" href="#Cable-dimensions">Cable dimensions</a><a id="Cable-dimensions-1"></a><a class="docs-heading-anchor-permalink" href="#Cable-dimensions" title="Permalink"></a></h2><p>The cable under consideration is a high-voltage, stranded copper conductor cable with XLPE insulation, water-blocking tape, lead tubular screens, PE inner sheath, PP bedding, steel armor and PP jacket, rated for 525 kV HVDC systems. This information is typically found in the cable datasheet and is based on the design studied in [<a href="../../bib/#Karmokar2025">13</a>].</p><p>The cable is found to have the following configuration:</p><pre><code class="language-julia hljs">num_co_wires = 127 # number of core wires
num_ar_wires = 68  # number of armor wires
d_core = 0.0463    # nominal core overall diameter
d_w = 3.6649e-3    # nominal strand diameter of the core (minimum value to match datasheet)
t_sc_in = 2e-3     # nominal internal semicon thickness
t_ins = 26e-3      # nominal main insulation thickness
t_sc_out = 1.8e-3  # nominal external semicon thickness
t_wbt = .3e-3      # nominal thickness of the water blocking tape
t_sc = 3.3e-3      # nominal lead screen thickness
t_pe = 3e-3        # nominal PE inner sheath thickness
t_bed = 3e-3       # nominal thickness of the PP bedding
d_wa = 5.827e-3    # nominal armor wire diameter
t_jac = 10e-3      # nominal PP jacket thickness</code></pre><p>The cable structure is summarized in a table for better visualization, with dimensions in milimiters:</p><pre><code class="language- hljs">df = DataFrame( # hide
    layer=first.(layers), # hide
    thickness=[ # hide
        ismissing(t) ? &quot;-&quot; : round(t, sigdigits=2) for t in getindex.(layers, 2) # hide
    ], # hide
    diameter=[round(d, digits=2) for d in getindex.(layers, 3)], # hide
) # hide</code></pre><h2 id="Core-and-main-insulation"><a class="docs-heading-anchor" href="#Core-and-main-insulation">Core and main insulation</a><a id="Core-and-main-insulation-1"></a><a class="docs-heading-anchor-permalink" href="#Core-and-main-insulation" title="Permalink"></a></h2><p>Initialize the conductor object and assign the central wire:</p><pre><code class="language- hljs">material = get_material(materials_db, &quot;copper&quot;)
n = 6
core = ConductorGroup(WireArray(0, Diameter(d_w), 1, 0, material))</code></pre><p>Add the subsequent layers of wires and inspect the object:</p><pre><code class="language- hljs">addto_conductorgroup!(core, WireArray, Diameter(d_w), 1 * n, 11, material)
addto_conductorgroup!(core, WireArray, Diameter(d_w), 2 * n, 11, material)
addto_conductorgroup!(core, WireArray, Diameter(d_w), 3 * n, 11, material)
addto_conductorgroup!(core, WireArray, Diameter(d_w), 4 * n, 11, material)
addto_conductorgroup!(core, WireArray, Diameter(d_w), 5 * n, 11, material)
addto_conductorgroup!(core, WireArray, Diameter(d_w), 6 * n, 11, material)</code></pre><h3 id="Inner-semiconductor"><a class="docs-heading-anchor" href="#Inner-semiconductor">Inner semiconductor</a><a id="Inner-semiconductor-1"></a><a class="docs-heading-anchor-permalink" href="#Inner-semiconductor" title="Permalink"></a></h3><p>Inner semiconductor (1000 Ω.m as per IEC 840):</p><pre><code class="language- hljs">material = get_material(materials_db, &quot;semicon1&quot;)
main_insu = InsulatorGroup(Semicon(core, Thickness(t_sc_in), material))</code></pre><h3 id="Main-insulation"><a class="docs-heading-anchor" href="#Main-insulation">Main insulation</a><a id="Main-insulation-1"></a><a class="docs-heading-anchor-permalink" href="#Main-insulation" title="Permalink"></a></h3><p>Add the insulation layer:</p><pre><code class="language- hljs">material = get_material(materials_db, &quot;pe&quot;)
addto_insulatorgroup!(main_insu, Insulator, Thickness(t_ins), material)</code></pre><h3 id="Outer-semiconductor"><a class="docs-heading-anchor" href="#Outer-semiconductor">Outer semiconductor</a><a id="Outer-semiconductor-1"></a><a class="docs-heading-anchor-permalink" href="#Outer-semiconductor" title="Permalink"></a></h3><p>Outer semiconductor (500 Ω.m as per IEC 840):</p><pre><code class="language- hljs">material = get_material(materials_db, &quot;semicon2&quot;)
addto_insulatorgroup!(main_insu, Semicon, Thickness(t_sc_out), material)</code></pre><p>Water blocking (swellable) tape:</p><pre><code class="language- hljs">material = get_material(materials_db, &quot;polyacrylate&quot;)
addto_insulatorgroup!(main_insu, Semicon, Thickness(t_wbt), material)</code></pre><p>Group core-related components:</p><pre><code class="language- hljs">core_cc = CableComponent(&quot;core&quot;, core, main_insu)

cable_id = &quot;525kV_1600mm2&quot;
datasheet_info = NominalData(
    designation_code=&quot;(N)2XH(F)RK2Y&quot;,
    U0=500.0,                        # Phase (pole)-to-ground voltage [kV]
    U=525.0,                         # Phase (pole)-to-phase (pole) voltage [kV]
    conductor_cross_section=1600.0,  # [mm²]
    screen_cross_section=1000.0,     # [mm²]
    resistance=NaN,                  # DC resistance [Ω/km]
    capacitance=NaN,                 # Capacitance [μF/km]
    inductance=NaN,                  # Inductance in trifoil [mH/km]
)
cable_design = CableDesign(cable_id, core_cc, nominal_data=datasheet_info)</code></pre><p>At this point, it becomes possible to preview the cable design:</p><pre><code class="language- hljs">plt1 = preview_cabledesign(cable_design)</code></pre><h3 id="Lead-screen/sheath"><a class="docs-heading-anchor" href="#Lead-screen/sheath">Lead screen/sheath</a><a id="Lead-screen/sheath-1"></a><a class="docs-heading-anchor-permalink" href="#Lead-screen/sheath" title="Permalink"></a></h3><p>Build the wire screens on top of the previous layer:</p><pre><code class="language- hljs">material = get_material(materials_db, &quot;lead&quot;)
screen_con =
    ConductorGroup(Tubular(main_insu, Thickness(t_sc), material))</code></pre><p>PE inner sheath:</p><pre><code class="language- hljs">material = get_material(materials_db, &quot;pe&quot;)
screen_insu = InsulatorGroup(Insulator(screen_con, Thickness(t_pe), material))</code></pre><p>PP bedding:</p><pre><code class="language- hljs">material = get_material(materials_db, &quot;pp&quot;)
addto_insulatorgroup!(screen_insu, Insulator, Thickness(t_bed), material)</code></pre><p>Group sheath components and assign to design:</p><pre><code class="language- hljs">sheath_cc = CableComponent(&quot;sheath&quot;, screen_con, screen_insu)
addto_cabledesign!(cable_design, sheath_cc)</code></pre><p>Examine the newly added components:</p><pre><code class="language- hljs">plt2 = preview_cabledesign(cable_design)</code></pre><h3 id="Armor-and-outer-jacket-components"><a class="docs-heading-anchor" href="#Armor-and-outer-jacket-components">Armor and outer jacket components</a><a id="Armor-and-outer-jacket-components-1"></a><a class="docs-heading-anchor-permalink" href="#Armor-and-outer-jacket-components" title="Permalink"></a></h3><p>Add the armor wires on top of the previous layer:</p><pre><code class="language- hljs">lay_ratio = 10 # typical value for wire screens
material = get_material(materials_db, &quot;steel&quot;)
armor_con =
    ConductorGroup(WireArray(screen_insu, Diameter(d_wa), num_ar_wires, lay_ratio, material))</code></pre><p>PP layer after armor:</p><pre><code class="language- hljs">material = get_material(materials_db, &quot;pp&quot;)
armor_insu = InsulatorGroup(Insulator(armor_con, Thickness(t_jac), material))</code></pre><p>Assign the armor parts directly to the design:</p><pre><code class="language- hljs">addto_cabledesign!(cable_design, &quot;armor&quot;, armor_con, armor_insu)</code></pre><p>Inspect the finished cable design:</p><pre><code class="language- hljs">plt3 = preview_cabledesign(cable_design)</code></pre><h2 id="Examining-the-cable-parameters-(RLC)"><a class="docs-heading-anchor" href="#Examining-the-cable-parameters-(RLC)">Examining the cable parameters (RLC)</a><a id="Examining-the-cable-parameters-(RLC)-1"></a><a class="docs-heading-anchor-permalink" href="#Examining-the-cable-parameters-(RLC)" title="Permalink"></a></h2><p>In this section, the cable design is examined and the calculated parameters are compared with datasheet values. <a href="../../#LineCableModels.jl"><code>LineCableModels.jl</code></a> provides methods to analyze the design in different levels of detail.</p><p>Summarize DC lumped parameters (R, L, C):</p><pre><code class="language- hljs">core_df = cabledesign_todf(cable_design, :baseparams)
display(core_df)</code></pre><p>Obtain the equivalent electromagnetic properties of the cable:</p><pre><code class="language- hljs">components_df = cabledesign_todf(cable_design, :components)
display(components_df)</code></pre><h2 id="Saving-the-cable-design"><a class="docs-heading-anchor" href="#Saving-the-cable-design">Saving the cable design</a><a id="Saving-the-cable-design-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-the-cable-design" title="Permalink"></a></h2><p>Load an existing <a href="../../reference/#LineCableModels.DataModel.CablesLibrary"><code>CablesLibrary</code></a> file or create a new one:</p><pre><code class="language- hljs">library = CablesLibrary()
library_file = joinpath(@__DIR__, &quot;cables_library.json&quot;)
load_cableslibrary!(library, file_name=library_file)
store_cableslibrary!(library, cable_design)
list_cableslibrary(library)</code></pre><p>Save to file for later use:</p><pre><code class="language- hljs">save_cableslibrary(library, file_name=library_file);
nothing #hide</code></pre><h3 id="Defining-a-cable-system"><a class="docs-heading-anchor" href="#Defining-a-cable-system">Defining a cable system</a><a id="Defining-a-cable-system-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-a-cable-system" title="Permalink"></a></h3><h3 id="Earth-model"><a class="docs-heading-anchor" href="#Earth-model">Earth model</a><a id="Earth-model-1"></a><a class="docs-heading-anchor-permalink" href="#Earth-model" title="Permalink"></a></h3><p>Define a frequency-dependent earth model (1 Hz to 1 MHz):</p><pre><code class="language- hljs">f = 10.0 .^ range(0, stop=6, length=10)  # Frequency range
earth_params = EarthModel(f, 100.0, 10.0, 1.0)  # 100 Ω·m resistivity, εr=10, μr=1</code></pre><p>Earth model base (DC) properties:</p><pre><code class="language- hljs">earthmodel_df = earthmodel_todf(earth_params)
display(earthmodel_df)</code></pre><h3 id="Underground-bipole-configuration"><a class="docs-heading-anchor" href="#Underground-bipole-configuration">Underground bipole configuration</a><a id="Underground-bipole-configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Underground-bipole-configuration" title="Permalink"></a></h3><pre><code class="language-julia hljs">xp = -0.5
xn = 0.5
y0 = -1.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-1.0</code></pre><p>Initialize the <code>LineCableSystem</code> with positive pole:</p><pre><code class="language- hljs">cablepos = CablePosition(cable_design, xp, y0, Dict(&quot;core&quot; =&gt; 1, &quot;sheath&quot; =&gt; 0, &quot;armor&quot; =&gt; 0))
cable_system = LineCableSystem(&quot;525kV_1600mm2_bipole&quot;, 1000.0, cablepos)</code></pre><p>Add remaining cables (phases B and C):</p><pre><code class="language- hljs">addto_linecablesystem!(cable_system, cable_design, xn, y0,
    Dict(&quot;core&quot; =&gt; 2, &quot;sheath&quot; =&gt; 0, &quot;armor&quot; =&gt; 0),
)</code></pre><h3 id="Cable-system-preview"><a class="docs-heading-anchor" href="#Cable-system-preview">Cable system preview</a><a id="Cable-system-preview-1"></a><a class="docs-heading-anchor-permalink" href="#Cable-system-preview" title="Permalink"></a></h3><p>In this section the complete bipole cable system is examined.</p><p>Display system details:</p><pre><code class="language- hljs">system_df = linecablesystem_todf(cable_system)
display(system_df)</code></pre><p>Visualize the cross-section of the three-phase system:</p><pre><code class="language- hljs">plt4 = preview_linecablesystem(cable_system, zoom_factor=0.15)</code></pre><h2 id="PSCAD-export"><a class="docs-heading-anchor" href="#PSCAD-export">PSCAD export</a><a id="PSCAD-export-1"></a><a class="docs-heading-anchor-permalink" href="#PSCAD-export" title="Permalink"></a></h2><p>The final step showcases how to export the model for electromagnetic transient simulations in PSCAD.</p><p>Export to PSCAD input file:</p><pre><code class="language- hljs">output_file = joinpath(@__DIR__, &quot;$(cable_system.system_id)_export.pscx&quot;)
export_file = export_pscad_lcp(cable_system, earth_params, file_name=output_file);
nothing #hide</code></pre><h2 id="FEM-calculations"><a class="docs-heading-anchor" href="#FEM-calculations">FEM calculations</a><a id="FEM-calculations-1"></a><a class="docs-heading-anchor-permalink" href="#FEM-calculations" title="Permalink"></a></h2><p>Define a LineParametersProblem with the cable system and earth model</p><pre><code class="language- hljs">f = 1e-3
problem = LineParametersProblem(
    cable_system,
    temperature=20.0,  # Operating temperature
    earth_props=earth_params,
    frequencies=[f],  # Frequency for the analysis
)</code></pre><p>Create a FEMFormulation with custom mesh definitions</p><pre><code class="language- hljs">skin_depth_earth = abs(sqrt(earth_params.layers[end].rho_g[1] / (1im * (2 * pi * f[1]) * earth_params.layers[end].mu_g[1])))
domain_radius = clamp(skin_depth_earth, 5.0, 5000.0)

mesh_transition1 = MeshTransition(
    cable_system,
    [1],
    r_min=0.0,
    r_length=0.25,
    mesh_factor_min=0.01 / (domain_radius / 5),
    mesh_factor_max=0.25 / (domain_radius / 5),
    n_regions=5
)

mesh_transition2 = MeshTransition(
    cable_system,
    [2],
    r_min=0.0,
    r_length=0.25,
    mesh_factor_min=0.01 / (domain_radius / 5),
    mesh_factor_max=0.25 / (domain_radius / 5),
    n_regions=5
)

formulation = FEMFormulation(
    domain_radius=domain_radius,
    domain_radius_inf=domain_radius * 1.25,
    elements_per_length_conductor=1,
    elements_per_length_insulator=2,
    elements_per_length_semicon=1,
    elements_per_length_interfaces=5,
    points_per_circumference=16,
    analysis_type=(FEMDarwin(), FEMElectrodynamics()),
    mesh_size_min=1e-6,
    mesh_size_max=domain_radius / 5,
    mesh_transitions=[mesh_transition1, mesh_transition2],
    mesh_size_default=domain_radius / 10,
    mesh_algorithm=5,
    mesh_max_retries=20,
    materials_db=materials_db
)</code></pre><p>Define runtime FEMOptions</p><pre><code class="language- hljs">opts = FEMOptions(
    force_remesh=true,  # Force remeshing
    force_overwrite=true,
    plot_field_maps=false,
    mesh_only=false,  # Preview the mesh
    base_path=joinpath(@__DIR__, &quot;fem_output&quot;),
    keep_run_files=true,  # Archive files after each run
    verbosity=2,  # Verbose output
    getdp_executable=joinpath(&quot;/home/amartins/Applications/onelab-Linux64&quot;, &quot;getdp&quot;), # Path to GetDP executable
)</code></pre><p>Run the FEM model</p><pre><code class="language- hljs">@time workspace, line_params = compute!(problem, formulation, opts)

if !opts.mesh_only
    println(&quot;\nR = $(round(real(line_params.Z[1,1,1])*1000, sigdigits=4)) Ω/km&quot;)
    println(&quot;L = $(round(imag(line_params.Z[1,1,1])/(2π*f)*1e6, sigdigits=4)) mH/km&quot;)
    println(&quot;C = $(round(imag(line_params.Y[1,1,1])/(2π*f)*1e9, sigdigits=4)) μF/km&quot;)
end</code></pre><hr/><p>🏠 Back to <a href="../#Tutorials">Tutorials</a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial2/">« Tutorial 2 - Building a cable design</a><a class="docs-footer-nextpage" href="../../reference/">Toolbox reference »</a><div class="flexbox-break"></div><p class="footer-message"><a href="https://github.com/Electa-Git/LineCableModels.jl">LineCableModels.jl</a> v0.1.1-DEV supported by the Etch Competence Hub of EnergyVille, financed by the Flemish Government.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 8 August 2025 11:14">Friday 8 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
